# MOT Club 개발 가이드

## 개발 환경 설정

### 필수 요구사항
- **Node.js**: 18.x 이상
- **npm**: 9.x 이상
- **Git**: 최신 버전
- **코드 에디터**: VSCode 권장

### 프로젝트 설정

```bash
# 1. 저장소 클론
git clone <repository-url>
cd mot_prj

# 2. 의존성 설치
npm install

# 3. 환경 변수 설정
cp .env.example .env.local  # 존재하는 경우
# 또는 수동으로 .env.local 생성

# 4. 개발 서버 실행
npm run dev
```

### 환경 변수 설정

`.env.local` 파일 생성:

```env
# API 설정
NEXT_PUBLIC_API_URL=http://localhost:8084
API_URL=http://localhost:8084

# 개발 환경
NODE_ENV=development

# 텔레메트리 비활성화
NEXT_TELEMETRY_DISABLED=1
```

## 프로젝트 구조 이해

### 디렉토리 역할

```
src/
├── app/                    # Next.js App Router
│   ├── layout.tsx         # 전역 레이아웃
│   ├── page.tsx           # 홈페이지
│   └── [feature]/         # 기능별 페이지
│
├── components/            # React 컴포넌트
│   ├── common/           # 공통 컴포넌트
│   └── [feature]/        # 기능별 컴포넌트
│
├── context/              # React Context
│   └── AuthContext.tsx   # 인증 상태
│
├── config/               # 설정 파일
│   └── api.ts           # API 설정
│
├── utils/                # 유틸리티 함수
│   └── api.ts           # API 호출 함수
│
└── types/                # TypeScript 타입
    └── [feature].ts     # 기능별 타입
```

## 코딩 컨벤션

### TypeScript

```typescript
// 인터페이스 정의
interface User {
  id: number;
  email: string;
  name: string;
  role: 'USER' | 'ADMIN' | 'EXPERT';
}

// 타입 정의
type UserRole = 'USER' | 'ADMIN' | 'EXPERT';

// 함수 타입 정의
const fetchUser = async (id: number): Promise<User> => {
  // 구현
};
```

### React 컴포넌트

```typescript
// 함수형 컴포넌트 (FC 사용)
import { FC } from 'react';

interface Props {
  title: string;
  onClose: () => void;
}

const MyComponent: FC<Props> = ({ title, onClose }) => {
  return (
    <div>
      <h1>{title}</h1>
      <button onClick={onClose}>닫기</button>
    </div>
  );
};

export default MyComponent;
```

### 파일 명명 규칙

```
컴포넌트:     PascalCase.tsx     (UserProfile.tsx)
유틸리티:     camelCase.ts       (dateUtils.ts)
타입:         camelCase.ts       (user.ts)
API:          camelCase.ts       (userApi.ts)
페이지:       page.tsx           (app/users/page.tsx)
레이아웃:     layout.tsx         (app/layout.tsx)
```

## 주요 개발 패턴

### 1. API 호출 패턴

```typescript
import { get, post, put, delete as del } from '@/utils/api';

// GET 요청
const fetchData = async () => {
  try {
    const response = await get('/api/users');
    return response.data;
  } catch (error) {
    console.error('Error fetching data:', error);
    throw error;
  }
};

// POST 요청
const createData = async (data: any) => {
  try {
    const response = await post('/api/users', data);
    return response.data;
  } catch (error) {
    console.error('Error creating data:', error);
    throw error;
  }
};
```

### 2. 인증 사용 패턴

```typescript
'use client';

import { useAuth } from '@/context/AuthContext';

const MyPage = () => {
  const { user, isLoggedIn, login, logout } = useAuth();

  if (!isLoggedIn) {
    return <div>로그인이 필요합니다.</div>;
  }

  return (
    <div>
      <p>환영합니다, {user?.name}님!</p>
      <button onClick={logout}>로그아웃</button>
    </div>
  );
};
```

### 3. 모달 패턴

```typescript
import { useState } from 'react';

const MyComponent = () => {
  const [isModalOpen, setIsModalOpen] = useState(false);

  return (
    <>
      <button onClick={() => setIsModalOpen(true)}>
        모달 열기
      </button>

      {isModalOpen && (
        <Modal onClose={() => setIsModalOpen(false)}>
          {/* 모달 내용 */}
        </Modal>
      )}
    </>
  );
};
```

### 4. 폼 처리 패턴

```typescript
import { useState, FormEvent } from 'react';

const MyForm = () => {
  const [formData, setFormData] = useState({
    title: '',
    content: ''
  });

  const handleSubmit = async (e: FormEvent) => {
    e.preventDefault();

    try {
      await post('/api/items', formData);
      alert('저장되었습니다.');
    } catch (error) {
      alert('저장 실패');
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        value={formData.title}
        onChange={(e) => setFormData({
          ...formData,
          title: e.target.value
        })}
      />
      <button type="submit">제출</button>
    </form>
  );
};
```

## 개발 스크립트

### 로컬 개발

```bash
# 기본 개발 서버 (localhost:3002)
npm run dev

# 로컬 백엔드 연동 (localhost:8084)
npm run dev:local

# 개발 서버 연동 (192.168.0.101:8084)
npm run dev:dev

# 스테이징 서버 연동 (www.motclub.co.kr)
npm run dev:staging

# 프로덕션 서버 연동
npm run dev:prod
```

### 빌드 및 테스트

```bash
# ESLint 실행
npm run lint

# 타입 체크
npx tsc --noEmit

# 프로덕션 빌드
npm run build:prod

# 빌드 결과 실행
npm run start
```

### 캐시 정리

```bash
# 빌드 캐시 및 폴더 삭제
npm run clean
```

## 디버깅

### 브라우저 개발자 도구

```javascript
// 콘솔 로깅
console.log('데이터:', data);
console.error('에러:', error);

// 네트워크 탭
// - API 요청/응답 확인
// - 헤더 확인
// - 페이로드 확인
```

### React DevTools

```bash
# Chrome 확장 프로그램 설치
React Developer Tools
```

### Next.js 디버깅

```javascript
// next.config.js에서 소스맵 활성화
module.exports = {
  productionBrowserSourceMaps: true,
};
```

## 일반적인 이슈 및 해결

### 1. API 호출 실패

```typescript
// 문제: CORS 에러
// 해결: next.config.js의 rewrites 확인

// 문제: 404 에러
// 해결: API_BASE_URL 환경 변수 확인
console.log('API URL:', process.env.NEXT_PUBLIC_API_URL);
```

### 2. 빌드 에러

```bash
# 문제: 메모리 부족
# 해결: 메모리 할당 증가
NODE_OPTIONS="--max-old-space-size=8192" npm run build

# 문제: 타입 에러
# 해결: TypeScript 설정 확인 또는 임시로 무시
# next.config.js에서 ignoreBuildErrors: true
```

### 3. PDF 뷰어 오류

```typescript
// 문제: PDF 워커 로드 실패
// 해결: public/pdf.worker.min.js 파일 확인
// next.config.js의 webpack 설정 확인
```

### 4. 세션 스토리지 이슈

```typescript
// 문제: 로그인 상태 유지 안됨
// 해결: sessionStorage 키 확인
const user = sessionStorage.getItem('user');
if (!user) {
  // 로그인 페이지로 리다이렉트
}
```

## 새로운 기능 추가 가이드

### 1. 새 페이지 추가

```bash
# 1. 페이지 파일 생성
src/app/my-feature/page.tsx

# 2. 컴포넌트 생성
src/components/my-feature/MyFeature.tsx

# 3. 타입 정의
src/types/myFeature.ts

# 4. API 함수 추가
src/utils/myFeatureApi.ts
```

### 2. 새 API 엔드포인트 추가

```typescript
// src/config/api.ts
export const API_ENDPOINTS = {
  // ... 기존 엔드포인트
  MY_FEATURE: '/api/my-feature',
};

// src/utils/myFeatureApi.ts
import { get, post } from './api';
import { API_ENDPOINTS } from '@/config/api';

export const fetchMyFeature = () => get(API_ENDPOINTS.MY_FEATURE);
export const createMyFeature = (data: any) =>
  post(API_ENDPOINTS.MY_FEATURE, data);
```

### 3. 새 컴포넌트 추가

```typescript
// src/components/my-feature/MyFeature.tsx
'use client';

import { FC, useEffect, useState } from 'react';
import { fetchMyFeature } from '@/utils/myFeatureApi';

const MyFeature: FC = () => {
  const [data, setData] = useState(null);

  useEffect(() => {
    const loadData = async () => {
      const result = await fetchMyFeature();
      setData(result);
    };
    loadData();
  }, []);

  return <div>{/* 컴포넌트 내용 */}</div>;
};

export default MyFeature;
```

## 스타일링 가이드

### Tailwind CSS

```typescript
// 기본 사용
<div className="flex items-center justify-center p-4 bg-blue-500">
  <h1 className="text-2xl font-bold text-white">제목</h1>
</div>

// 반응형 디자인
<div className="w-full md:w-1/2 lg:w-1/3">
  {/* 내용 */}
</div>

// 조건부 스타일
<button
  className={`
    px-4 py-2 rounded
    ${isActive ? 'bg-blue-500' : 'bg-gray-300'}
  `}
>
  버튼
</button>
```

### 커스텀 색상 (tailwind.config.ts)

```typescript
colors: {
  motBlue: '#1a73e8',
  motGray: '#f5f5f5',
  // ...
}

// 사용
<div className="bg-motBlue text-white">
```

## 테스트 (향후 추가 권장)

```bash
# Jest + React Testing Library 설치
npm install --save-dev jest @testing-library/react @testing-library/jest-dom

# 테스트 실행
npm test
```

## 코드 리뷰 체크리스트

- [ ] TypeScript 타입이 올바르게 정의되었는가?
- [ ] 에러 처리가 적절히 되었는가?
- [ ] 불필요한 console.log가 없는가?
- [ ] 코드 중복이 없는가?
- [ ] 컴포넌트가 재사용 가능한가?
- [ ] 성능 이슈가 없는가? (불필요한 리렌더링 등)
- [ ] 접근성(a11y)이 고려되었는가?
- [ ] 보안 이슈가 없는가? (XSS, SQL injection 등)

## 추가 리소스

- [Next.js 공식 문서](https://nextjs.org/docs)
- [React 공식 문서](https://react.dev)
- [TypeScript 공식 문서](https://www.typescriptlang.org/docs)
- [Tailwind CSS 공식 문서](https://tailwindcss.com/docs)
